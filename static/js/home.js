async function home_report() {
    fetch("/api/v1/reports/recent", {
        method: "GET",
        mode: 'cors',
        headers: {
            "Content-type": "application/json",
            "Authorization": "Bearer " + localStorage.getItem("token")
        }
    }).then(async (response) => {
        // get json response here
        let data = await response.json();
        if (response.status == 200) {
            var table = $("#table_home_report").DataTable();
            table.clear();

            for (let r of data) {
                let statusClass = r['status'] === 'Open' ? 'badge-light-info' : 'badge-light-success';
               
                table.row.add([
                    `<div class="d-flex align-items-center">
                        <div class="d-flex flex-column justify-content-center">
                            <a data-id="`+ r['id'] +`" href="/report/`+ r['id'] +`" class="fs-6 text-gray-800 text-hover-primary">${r['name']}</a>
                        </div>
                    </div>`,
                    r['date'],
                    r['author'],
                    `<div class="badge ${statusClass} fw-bold px-4 py-3">${r['status']}</div>`
                ]).draw(false);
            }
        } else {
            window.location.replace("/login");
        }
    });
};

    
home_report();


async function top_users() {
    fetch("/api/v1/users/top", {
    method: "GET",
    mode: 'cors',
    headers: {
        "Content-type": "application/json",
        "Authorization": "Bearer " + localStorage.getItem("token")
    }
    }).then(async (response) => {
        // get json response here
        let data = await response.json();
        if (response.status == 200) {
            for (let r of data) {
              document.getElementById("topusers").innerHTML += `
                <div class="d-flex align-items-sm-center mb-7">
					<div class="symbol symbol-50px me-5">
                        <span class="symbol-label">
                            <img src="static/media/avatars/blank.png" class="h-50 align-self-center" alt="">                         
                        </span>
                    </div>
                    <div class="d-flex align-items-center flex-row-fluid flex-wrap">                    
                        <div class="flex-grow-1 me-2">
                            <a href="#" class="text-gray-800 text-hover-primary fs-6 fw-bold">`+ r['username'] +`</a>
                        </div>                     
                        <span class="badge badge-light fw-bold my-2">`+ r['total_findings'] +`</span>
                    </div>
				</div>  
                <div class="separator separator-dashed my-4"></div>
              `;
            }
        } else {
            window.location.replace("/login");
        }
    });
};
    
top_users();